let n="";chrome.runtime.onInstalled.addListener(()=>{console.log("UsersPrompts AI Extension installed")});chrome.runtime.onMessage.addListener((e,r,t)=>{var c;if(console.log("Background received message:",e),e.type==="OPEN_POPUP"&&(console.log("Opening popup..."),chrome.action.openPopup(),t({success:!0})),e.type==="OPEN_POPUP_WITH_TEXT"){const o=e.text||((c=e.data)==null?void 0:c.text)||"";return n=o,console.log("Storing text and opening popup:",o.substring(0,50)+"..."),chrome.storage.local.set({selectedText:o},()=>{chrome.action.openPopup(),t({success:!0})}),!0}return e.type==="GET_LAST_TEXT"?(t({text:n}),!0):(e.type==="OPTIMIZE_PROMPT"&&(console.log("Received prompt optimization request:",e.data),t({success:!0})),e.type==="SCORE_PROMPT"&&(console.log("Received prompt scoring request:",e.data),t({success:!0})),!0)});chrome.runtime.onInstalled.addListener(()=>{try{chrome.contextMenus.create({id:"optimizePrompt",title:"Optimize Prompt with UsersPrompts",contexts:["selection"]}),console.log("Context menu created")}catch(e){console.log("Context menus not available:",e)}});var i;(i=chrome.contextMenus)==null||i.onClicked.addListener((e,r)=>{e.menuItemId==="optimizePrompt"&&e.selectionText&&(console.log("Context menu clicked, storing text:",e.selectionText.substring(0,50)+"..."),chrome.storage.local.set({selectedText:e.selectionText},()=>{chrome.action.openPopup()}))});chrome.action.onClicked.addListener(e=>{console.log("Extension icon clicked"),chrome.action.openPopup()});
